SHELL:= /bin/bash
.SILENT:
MAKEFLAGS += --warn-undefined-variables

export OVERRIDE_EXTENSION OUTPUT_FOLDER

.ONESHELL: prepare
prepare:
	cat <<-EOF > ${OUTPUT_FOLDER}/${OVERRIDE_EXTENSION}.env
		COMMON_NAME=${COMMON_NAME}
		CLOUD_HOST=${CLOUD_HOST}
		FLICKR_PRIVATE_KEY=${FLICKR_PRIVATE_KEY}
		FLICKR_PUBLIC_KEY=${FLICKR_PUBLIC_KEY}
		UNSPLASH_PRIVATE_KEY=${UNSPLASH_PRIVATE_KEY}
		UNSPLASH_PUBLIC_KEY=${UNSPLASH_PUBLIC_KEY}
		PEXELS_PUBLIC_KEY=${PEXELS_PUBLIC_KEY}
		AWS_REGION_NAME=${AWS_REGION_NAME}
		AWS_ACCESS_KEY=${AWS_ACCESS_KEY}
		AWS_SECRET_KEY=${AWS_SECRET_KEY}
	EOF
	sed -i 's/package .*/package scraper_backend_test/' ${OUTPUT_FOLDER}/config_override.go